<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>CC.2.3.3 Service Class Provider Behavior</title>
      <link rel="stylesheet" type="text/css" href="dicom.css" />
      <meta name="generator" content="DocBook XSL Stylesheets V1.78.1" />
      <link rel="home" href="PS3.4.html" title="PS3.4" />
      <link rel="up" href="sect_CC.2.3.html" title="CC.2.3 Subscribe/Unsubscribe to Receive UPS Event Reports (N-ACTION)" />
      <link rel="prev" href="sect_CC.2.3.2.html" title="CC.2.3.2 Service Class User Behavior" />
      <link rel="next" href="sect_CC.2.3.4.html" title="CC.2.3.4 Status Codes" />
      <style type="text/css"><![CDATA[
	p { font-size: 15px; }
      ]]></style>
   </head>
   <body>
      <table xmlns="" xmlns:d="http://docbook.org/ns/docbook" width="100%">
         <tr>
            <th colspan="1" align="center" rowspan="1">
               <span class="documentreleaseinformation">DICOM PS3.4 2024a - Service Class Specifications</span>
            </th>
         </tr>
      </table>
      <div xmlns="" class="navheader">
         <table width="100%" summary="Navigation header">
            <tr>
               <th colspan="3" align="center" rowspan="1">CC.2.3.3 Service Class Provider Behavior <a accesskey="current" href="http://dicom.nema.org/medical/dicom/current/output/chtml/part04/sect_CC.2.3.3.html" shape="rect">(Current)</a>
               </th>
            </tr>
            <tr>
               <td width="20%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="sect_CC.2.3.2.html" shape="rect">Prev</a> </td>
               <th width="60%" align="center" rowspan="1" colspan="1">CC.2.3 Subscribe/Unsubscribe to Receive UPS Event Reports (N-ACTION)</th>
               <td width="20%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="sect_CC.2.3.4.html" shape="rect">Next</a>
               </td>
            </tr>
         </table>
         <hr />
      </div>
      <div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="breadcrumbs">
         <span class="breadcrumb-link">
            <a href="PS3.4.html" shape="rect">PS3.4</a>
         </span> &gt; <span class="breadcrumb-link">
            <a href="chapter_CC.html" shape="rect">Unified Procedure Step Service and SOP Classes (Normative)</a>
         </span> &gt; <span class="breadcrumb-link">
            <a href="sect_CC.2.html" shape="rect">DIMSE Service Groups</a>
         </span> &gt; <span class="breadcrumb-link">
            <a href="sect_CC.2.3.html" shape="rect">Subscribe/Unsubscribe to Receive UPS Event Reports (N-ACTION)</a>
         </span> &gt; <span class="breadcrumb-node">Service Class Provider Behavior</span>
      </div>
      <div class="section">
         <div class="titlepage">
            <div>
               <div>
                  <h4 class="title">
                     <a id="sect_CC.2.3.3" shape="rect"></a>CC.2.3.3 Service Class Provider Behavior</h4>
               </div>
            </div>
         </div>
         <p>
            <a id="para_10eff9b2-49a3-413b-b79c-49b5b88b06c9" shape="rect"></a>Upon receipt of the N-ACTION request, the SCP shall attempt to update the Global Subscription State and/or UPS Subscription State of the specified AE with respect to the specified SOP Instance UID as described in <a class="xref" href="sect_CC.2.3.html#table_CC.2.3-2" title="Table CC.2.3-2. UPS Subscription State Transition Table" shape="rect">Table CC.2.3-2</a> and then return, via the N-ACTION response primitive, the appropriate N-ACTION Response Status Code.</p>
         <p>
            <a id="para_4268f731-6774-4f12-ac5f-4f068bbeca18" shape="rect"></a>The SCP may optionally allow an Application Entity to subscribe globally to a filtered set of UPS Instances. In this case, the Application Entity will only be subscribed to existing and future UPS Instances that match the search criteria specified by the Matching Keys of the N-ACTION request (see <a class="xref" href="sect_CC.2.3.3.html#sect_CC.2.3.3.1" title="CC.2.3.3.1 Filtered Global Subscription" shape="rect">Section CC.2.3.3.1</a>). If the SCP does not support Filtered Global Subscription it will return a Failure response with a Code of C307 (see <a class="xref" href="sect_CC.2.3.4.html#table_CC.2.3-3" title="Table CC.2.3-3. N-ACTION Response Status Values [for Subscribe/Unsubscribe to Receive UPS sEvent Reports]" shape="rect">Table CC.2.3-3</a>).</p>
         <p>
            <a id="para_ed746007-b1a9-403c-bb0a-688fcd968487" shape="rect"></a>A success status conveys that the Global Subscription State and/or UPS Subscription State for the AE specified in Receiving AE (0074,1234) was successfully modified by the SCP. The AE-TITLE in Receiving AE (0074,1234) may be different than the AE-TITLE used by the SCU for the association negotiation. The SCP shall use the AE-TITLE specified in Receiving AE (0074,1234). This allows systems to subscribe other systems they know would be interested in events for a certain UPS.</p>
         <p>
            <a id="para_fe7ffbcc-fca4-441e-80b8-13042af905fe" shape="rect"></a>For all UPS instances managed by the SCP, the SCP shall send N-EVENT-REPORTS (as described in <a class="xref" href="sect_CC.2.4.3.html" title="CC.2.4.3 Service Class Provider Behavior" shape="rect">Section CC.2.4.3</a>) to AEs that have a UPS Subscription State of "Subscribed with Lock" or "Subscribed w/o Lock". If the SCP also supports the HTTP CreateSubscription service as an origin server, the SCP shall also send HTTP SendEventReport messages (see <a href="../part18/sect_8.10.5.html" class="olink" shape="rect">Section 8.10.5 “Send Event Report Transaction” in <span class="olinkdocname">PS3.18</span>
            </a>).</p>
         <p>
            <a id="para_2fc3597a-ccde-4b49-afb9-3d77de13cd26" shape="rect"></a>Upon successfully processing a subscription action, the SCP shall send initial UPS State Report N-EVENT-REPORTs, as indicated in <a class="xref" href="sect_CC.2.3.html#table_CC.2.3-2" title="Table CC.2.3-2. UPS Subscription State Transition Table" shape="rect">Table CC.2.3-2</a>, providing the current status of the UPS Instance to the Receiving AE.</p>
         <p>
            <a id="para_7370ad79-eac8-475e-9570-92d698943755" shape="rect"></a>The SCP may also refuse both specific and global Subscription requests by returning a failure N-ACTION Response Status Code for "Refused: Refused: Not authorized" if the refusal depends on permissions related to the tasks or the requestor, or "Refused: SCP does not support Event Reports" if the SCP does not support sending the events. The SCP must document in its conformance statement if it might refuse Subscription requests.</p>
         <p>
            <a id="para_92eb7ca3-c8ad-4e69-bad8-78ac21509adc" shape="rect"></a>The SCP may remove existing Deletion Locks by changing the UPS Subscription State for the AE from "Subscribed with Lock" to "Subscribed w/o Lock" and/or by changing the Global Subscription State for an AE from "Global Subscription with Lock" to "Global Subscription w/o Lock". This is intended to allow the SCP to deal with SCU malfunctions. The SCP must document in its conformance statement if it might remove a Deletion Lock.</p>
         <p>
            <a id="para_be6d1ad1-ec66-4df6-b47d-7aaa0637d74c" shape="rect"></a>The SCP may also refuse the Deletion Lock portion of a specific or global Subscription request. For example, a request to modify the UPS Subscription State for the AE to "Subscribed with Lock" would instead result in a UPS Subscription State of "Subscribed w/o Lock" and a Warning status (see <a class="xref" href="sect_CC.2.3.4.html#table_CC.2.3-3" title="Table CC.2.3-3. N-ACTION Response Status Values [for Subscribe/Unsubscribe to Receive UPS sEvent Reports]" shape="rect">Table CC.2.3-3</a>) returned to the requesting SCU. This is intended to deal with Security and related policy restrictions. The SCP must document in its conformance statement if it might refuse a Deletion Lock.</p>
         <p>
            <a id="para_e16b9d59-bd48-44e4-b448-f470d7c56992" shape="rect"></a>Bi-directional Authentication of machines/users/applications is possible at association time (see <a href="../part07/PS3.7.html" class="olink" shape="rect">PS3.7</a> and <a href="../part15/PS3.15.html" class="olink" shape="rect">PS3.15</a>). <a href="../part07/PS3.7.html" class="olink" shape="rect">PS3.7</a> provides a "Refused: Refused: Not authorized" error code. Further requiring or documenting authentication and/or authorization features from the SCU or SCP is beyond the scope of this SOP Class.</p>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h5 class="title">
                        <a id="sect_CC.2.3.3.1" shape="rect"></a>CC.2.3.3.1 Filtered Global Subscription</h5>
                  </div>
               </div>
            </div>
            <p>
               <a id="para_1a9c02cc-0035-4c1d-b432-aa4bc519fbe0" shape="rect"></a>An SCP that supports Filtered Global Subscription shall create an instance subscription for each UPS Instance that would match a C-FIND request with the Matching Keys provided in the subscription request.</p>
            <p>
               <a id="para_d3d528ad-d5f9-42e4-bf75-90e3b10badca" shape="rect"></a>The SCP shall support the same matching logic used for C-FIND (see <a class="xref" href="sect_CC.2.8.3.html" title="CC.2.8.3 Service Class Provider Behavior" shape="rect">Section CC.2.8.3</a>).</p>
         </div>
      </div>
      <div class="navfooter">
         <hr />
         <table width="100%" summary="Navigation footer">
            <tr>
               <td width="40%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="sect_CC.2.3.2.html" shape="rect">Prev</a> </td>
               <td width="20%" align="center" rowspan="1" colspan="1">
                  <a accesskey="u" href="sect_CC.2.3.html" shape="rect">Up</a>
               </td>
               <td width="40%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="sect_CC.2.3.4.html" shape="rect">Next</a>
               </td>
            </tr>
            <tr>
               <td width="40%" align="left" valign="top" rowspan="1" colspan="1">CC.2.3.2 Service Class User Behavior </td>
               <td width="20%" align="center" rowspan="1" colspan="1">
                  <a accesskey="h" href="PS3.4.html" shape="rect">Home</a>
               </td>
               <td width="40%" align="right" valign="top" rowspan="1" colspan="1"> CC.2.3.4 Status Codes</td>
            </tr>
         </table>
      </div>
      <table xmlns="" xmlns:d="http://docbook.org/ns/docbook" width="100%">
         <tr>
            <th colspan="1" align="center" rowspan="1">
               <span class="documentreleaseinformation">DICOM PS3.4 2024a - Service Class Specifications</span>
            </th>
         </tr>
      </table>
   </body>
</html>
