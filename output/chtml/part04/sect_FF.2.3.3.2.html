<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>FF.2.3.3.2 Internal Structure of RGB and RGBA Compositor Components</title>
      <link rel="stylesheet" type="text/css" href="dicom.css" />
      <meta name="generator" content="DocBook XSL Stylesheets V1.78.1" />
      <link rel="home" href="PS3.4.html" title="PS3.4" />
      <link rel="up" href="sect_FF.2.3.3.html" title="FF.2.3.3 Internal Structure of Components" />
      <link rel="prev" href="sect_FF.2.3.3.html" title="FF.2.3.3 Internal Structure of Components" />
      <link rel="next" href="sect_FF.2.4.html" title="FF.2.4 Additional Volumetric Considerations" />
      <style type="text/css"><![CDATA[
	p { font-size: 15px; }
      ]]></style>
   </head>
   <body>
      <table xmlns="" xmlns:d="http://docbook.org/ns/docbook" width="100%">
         <tr>
            <th colspan="1" align="center" rowspan="1">
               <span class="documentreleaseinformation">DICOM PS3.4 2024a - Service Class Specifications</span>
            </th>
         </tr>
      </table>
      <div xmlns="" class="navheader">
         <table width="100%" summary="Navigation header">
            <tr>
               <th colspan="3" align="center" rowspan="1">FF.2.3.3.2 Internal Structure of RGB and RGBA Compositor Components <a accesskey="current" href="http://dicom.nema.org/medical/dicom/current/output/chtml/part04/sect_FF.2.3.3.2.html" shape="rect">(Current)</a>
               </th>
            </tr>
            <tr>
               <td width="20%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="sect_FF.2.3.3.html" shape="rect">Prev</a> </td>
               <th width="60%" align="center" rowspan="1" colspan="1">FF.2.3.3 Internal Structure of Components</th>
               <td width="20%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="sect_FF.2.4.html" shape="rect">Next</a>
               </td>
            </tr>
         </table>
         <hr />
      </div>
      <div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="breadcrumbs">
         <span class="breadcrumb-link">
            <a href="PS3.4.html" shape="rect">PS3.4</a>
         </span> &gt; <span class="breadcrumb-link">
            <a href="chapter_FF.html" shape="rect">Volumetric Presentation State Storage SOP Classes (Normative)</a>
         </span> &gt; <span class="breadcrumb-link">
            <a href="sect_FF.2.html" shape="rect">Volume Transformation Processes</a>
         </span> &gt; <span class="breadcrumb-link">
            <a href="sect_FF.2.3.html" shape="rect">Volumetric Presentation State Display</a>
         </span> &gt; <span class="breadcrumb-link">
            <a href="sect_FF.2.3.3.html" shape="rect">Internal Structure of Components</a>
         </span> &gt; <span class="breadcrumb-node">Internal Structure of RGB and RGBA Compositor Components</span>
      </div>
      <div class="section">
         <div class="titlepage">
            <div>
               <div>
                  <h5 class="title">
                     <a id="sect_FF.2.3.3.2" shape="rect"></a>FF.2.3.3.2 Internal Structure of RGB and RGBA Compositor Components</h5>
               </div>
            </div>
         </div>
         <p>
            <a id="para_c62ad18a-ffd4-4206-8635-c2d210be2e86" shape="rect"></a>Weighting transfer functions that compute the weighting factors used by the Compositor Function as a function of Alpha<sub>1</sub> and Alpha<sub>2</sub> values are specified as weighting look-up tables (LUTs) in the RGB and RGBA Compositor components. The RGB and RGBA Compositor components are identical except for the compositing of the additional Alpha component in the RGBA Compositor:</p>
         <p>
            <a id="para_43944385-b63a-47cf-9834-1f7c023dd3bd" shape="rect"></a>
                            </p>
         <div class="figure">
            <a id="figure_FF.2-8" shape="rect"></a>
            <div class="figure-contents">
               <div class="mediaobject">
                  <img src="figures/PS3.4_FF.2-8.svg" alt="Internal Structure of RGB Compositor Component" />
               </div>
            </div>
            <p class="title">
               <strong>Figure FF.2-8. Internal Structure of RGB Compositor Component</strong>
            </p>
         </div>
         <p>
            <br class="figure-break" clear="none" />
                        </p>
         <p>
            <a id="para_1984e414-3509-4db5-ba3e-d5fac5d97764" shape="rect"></a>
                            </p>
         <div class="figure">
            <a id="figure_FF.2.3.3.2-1" shape="rect"></a>
            <div class="figure-contents">
               <div class="mediaobject">
                  <img src="figures/PS3.4_FF.2.3.3.2-1.svg" alt="Internal Structure of RGB and Opacity Compositor Component" />
               </div>
            </div>
            <p class="title">
               <strong>Figure FF.2.3.3.2-1. Internal Structure of RGB and Opacity Compositor Component</strong>
            </p>
         </div>
         <p>
            <br class="figure-break" clear="none" />
                        </p>
         <p>
            <a id="para_c4a76718-0e22-4950-9202-546202654424" shape="rect"></a>Because each Weighting LUT uses both Alpha values in determining a weighting factor, they allow compositing functions that would not be possible if each weighting factor were based only on that input's Alpha value. See <a href="../part17/sect_XXX.5.html" class="olink" shape="rect">Section XXX.5 “Compositing and the Use of Weighting Transfer Functions” in PS3.17</a> for typical usage of the Weighting LUTs.</p>
         <p>
            <a id="para_0ec8bfca-73ca-4878-a1f5-8e0191d693cc" shape="rect"></a>The input bits to the Weighting LUTs are obtained by combining the two Alpha inputs, with half the input bits obtained from each Alpha input:</p>
         <div class="itemizedlist">
            <ul class="itemizedlist" style="list-style-type: disc; ">
               <li class="listitem">
                  <p>
                     <a id="para_70944b16-f81f-4229-8821-034d037a0a99" shape="rect"></a>In the case of the first compositor component corresponding to the first item in Presentation State Compositor Component Sequence (0070,1805), the Alpha from the classification component corresponding to the first item in the Presentation State Classification Component Sequence (0070,1805) provides the most significant bits of the Weighting LUT inputs, while the Alpha from the classification component corresponding to the second item in the Presentation State Classification Component Sequence (0070,1805) provides the least significant bits of the Weighting LUT inputs.</p>
               </li>
               <li class="listitem">
                  <p>
                     <a id="para_4650508a-9e27-49e4-8f92-24ea3914d224" shape="rect"></a>In the case of subsequent compositor components, the Alpha from the classification component corresponding to the next item in the Presentation State Classification Component Sequence (0070,1805) provides the least significant bits of the Weighting LUT inputs, while the most significant bits of the Weighting LUT inputs are computed as one minus the Alpha from the classification component corresponding to the next item in the Presentation State Classification Component Sequence (0070,1805).</p>
               </li>
            </ul>
         </div>
         <p>
            <a id="para_616b9c87-c089-41df-895c-c1e6d63ce8fd" shape="rect"></a>The integer outputs of the Weighting LUTs are normalized to the range 0.0 to 1.0, and the Compositor Function combines the normalized R, G, B and Alpha (each component called "Color" = C<sub>x</sub>) input values as follows:</p>
         <p>
            <a id="para_1e5f21ad-8756-4e71-878e-ea0ff1165b6b" shape="rect"></a>
                            <span class="italic">C<sub>out</sub> = (C<sub>1</sub>*Weight<sub>1</sub>) + (C<sub>2</sub>*Weight<sub>2</sub>)</span>
                        </p>
         <p>
            <a id="para_951aa3dd-5b2c-4145-b72b-af5c58902aa5" shape="rect"></a>The sum of the normalized Weight<sub>1</sub> and Weight<sub>2</sub> shall be no greater than 1.0.</p>
         <p>
            <a id="para_d1adcc2f-52de-4dd8-90d8-73c5a99534bd" shape="rect"></a>The color input values are normalized because the number of output bits from the RGB Palette Color Lookup Tables and the Alpha Palette Color Lookup Table may be different in each classification component.</p>
         <p>
            <a id="para_0c74d115-7d32-4f7f-87fb-55e8d4ab8a0a" shape="rect"></a>The output of the compositor shall be range-limited ("clamped") to ensure that the outputs are guaranteed to be within a valid range of color values regardless of the validity of the weighting transfer functions. This isolates subsequent compositor components and the Profile Connection Space Transform from overflow errors.</p>
      </div>
      <div class="navfooter">
         <hr />
         <table width="100%" summary="Navigation footer">
            <tr>
               <td width="40%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="sect_FF.2.3.3.html" shape="rect">Prev</a> </td>
               <td width="20%" align="center" rowspan="1" colspan="1">
                  <a accesskey="u" href="sect_FF.2.3.3.html" shape="rect">Up</a>
               </td>
               <td width="40%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="sect_FF.2.4.html" shape="rect">Next</a>
               </td>
            </tr>
            <tr>
               <td width="40%" align="left" valign="top" rowspan="1" colspan="1">FF.2.3.3 Internal Structure of Components </td>
               <td width="20%" align="center" rowspan="1" colspan="1">
                  <a accesskey="h" href="PS3.4.html" shape="rect">Home</a>
               </td>
               <td width="40%" align="right" valign="top" rowspan="1" colspan="1"> FF.2.4 Additional Volumetric Considerations</td>
            </tr>
         </table>
      </div>
      <table xmlns="" xmlns:d="http://docbook.org/ns/docbook" width="100%">
         <tr>
            <th colspan="1" align="center" rowspan="1">
               <span class="documentreleaseinformation">DICOM PS3.4 2024a - Service Class Specifications</span>
            </th>
         </tr>
      </table>
   </body>
</html>
