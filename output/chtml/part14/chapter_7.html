<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>7 The Grayscale Standard Display Function</title>
      <link rel="stylesheet" type="text/css" href="dicom.css" />
      <meta name="generator" content="DocBook XSL Stylesheets V1.78.1" />
      <link rel="home" href="PS3.14.html" title="PS3.14" />
      <link rel="up" href="PS3.14.html" title="PS3.14" />
      <link rel="prev" href="chapter_6.html" title="6 Overview" />
      <link rel="next" href="sect_7.2.html" title="7.2 Transmissive Hardcopy Printers" />
      <style type="text/css"><![CDATA[
	p { font-size: 15px; }
      ]]></style>
   </head>
   <body>
      <table xmlns="" xmlns:d="http://docbook.org/ns/docbook" width="100%">
         <tr>
            <th colspan="1" align="center" rowspan="1">
               <span class="documentreleaseinformation">DICOM PS3.14 - Grayscale Standard Display Function</span>
            </th>
         </tr>
      </table>
      <div xmlns="" class="navheader">
         <table width="100%" summary="Navigation header">
            <tr>
               <th colspan="3" align="center" rowspan="1">7 The Grayscale Standard Display Function <a accesskey="current" href="http://dicom.nema.org/medical/dicom/current/output/chtml/part14/chapter_7.html" shape="rect">(Current)</a>
               </th>
            </tr>
            <tr>
               <td width="20%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="chapter_6.html" shape="rect">Prev</a> </td>
               <th width="60%" align="center" rowspan="1" colspan="1"> </th>
               <td width="20%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="sect_7.2.html" shape="rect">Next</a>
               </td>
            </tr>
         </table>
         <hr />
      </div>
      <div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="breadcrumbs">
         <span class="breadcrumb-link">
            <a href="PS3.14.html" shape="rect">PS3.14</a>
         </span> &gt; <span class="breadcrumb-node">The Grayscale Standard Display Function</span>
      </div>
      <div class="chapter">
         <div class="titlepage">
            <div>
               <div>
                  <h1 class="title">
                     <a id="chapter_7" shape="rect"></a>7 The Grayscale Standard Display Function</h1>
               </div>
            </div>
         </div>
         <p>
            <a id="para_db5ab40f-e31f-47ba-91e1-d379b8ab62ad" shape="rect"></a>As explained in greater detail in <a class="xref" href="chapter_A.html" title="A Derivation of the Grayscale Standard Display Function (Informative)" shape="rect">Annex A</a>, the Grayscale Standard Display Function is based on human Contrast Sensitivity.
          Human Contrast Sensitivity is distinctly non-linear within the Luminance Range of the Grayscale Standard Display Function.
          The sensitivity of the human visual system is <span class="italic">relatively</span> less sensitive in the dark areas of an image than it is in the bright areas of an image.
          This variation in sensitivity makes it much easier to see small relative changes in Luminance in the bright areas of the image than in the dark areas of the image.
          A Display Function that adjusts the brightness such that equal changes in P-Values will result in the same level of perceptibility at all driving levels is "perceptually linearized".
          The Grayscale Standard Display Function incorporates the notion of perceptual linearization without making it an explicit objective of this PS3.14.</p>
         <p>
            <a id="para_b60c0694-f3e1-495c-9fb4-757e37f905b1" shape="rect"></a>The employed data for Contrast Sensitivity are derived from Barten's model of the human visual system (Ref. 1, 2 and <a class="xref" href="chapter_B.html" title="B Table of the Grayscale Standard Display Function (Informative)" shape="rect">Annex B</a>). Specifically, the Grayscale Standard Display Function refers to Contrast Sensitivity for the Standard Target consisting of a 2-deg x 2-deg square filled with a horizontal or vertical grating with sinusoidal modulation of 4 cycles per degree. The square is placed in a uniform background of Luminance equal to the mean Luminance L of the Target. The Contrast Sensitivity is defined by the Threshold Modulation at which the grating becomes just visible to the average human observer. The Luminance modulation represents the Just-Noticeable Difference (JND) for the Target at the Luminance L.</p>
         <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
            <h3 class="title">Note</h3>
            <p>
               <a id="para_24ed6a3e-5e5f-42c0-9678-a4a436a0f0f0" shape="rect"></a>The academic nature of the Standard Target is recognized. With the simple target, the essential objectives of PS3.14 appear to be realizable. Only spurious results with more realistic targets in complex surroundings were known at the time of writing PS3.14 and these were not assessed.</p>
         </div>
         <p>
            <a id="para_bf1cdb53-fb97-489a-a26f-b4b6101f94d0" shape="rect"></a>The Grayscale Standard Display Function is defined for the Luminance Range from 0.05 to 4000 cd/m<sup>2</sup>. The minimum Luminance corresponds to the lowest practically useful Luminance of cathode-ray-tube (CRT) monitors and the maximum exceeds the unattenuated Luminance of very bright light-boxes used for interpreting X-Ray mammography. The Grayscale Standard Display Function explicitly includes the effects of the diffused ambient Illuminance.</p>
         <p>
            <a id="para_ec20ac4b-ad3c-465d-8bb0-39881a7b18ca" shape="rect"></a>Within the Luminance Range happen to fall 1023 JNDs (see <a class="xref" href="chapter_A.html" title="A Derivation of the Grayscale Standard Display Function (Informative)" shape="rect">Annex A</a>).</p>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h2 class="title" style="clear: both">
                        <a id="sect_7.1" shape="rect"></a>7.1 General Formulas</h2>
                  </div>
               </div>
            </div>
            <p>
               <a id="para_7108f5fd-5799-4153-8c69-e4853ed8bbeb" shape="rect"></a>The Grayscale Standard Display Function is defined by a mathematical interpolation of the 1023 Luminance levels derived from Barten's model. The Grayscale Standard Display Function allows us to calculate luminance, L, in candelas per square meter, as a function of the Just-Noticeable Difference (JND) Index, j:</p>
            <p>
               <a id="para_95c41918-a8ff-4600-8c15-27ff6be96583" shape="rect"></a>
        
            </p>
            <div class="equation">
               <a id="equation_7-1" shape="rect"></a>
               <p class="title">
                  <strong>Equation 7-1. </strong>
               </p>
               <div class="equation-contents">
                  <object type="image/svg+xml" data="figures/chapter_7_image_1.svg" style="">
                     <param name="src" value="image_1.svg" />
                  </object>
               </div>
            </div>
            <p>
               <br class="equation-break" clear="none" />
            </p>
            <p>
               <a id="para_5b892feb-b508-4e2f-bc65-52bd0690bb57" shape="rect"></a>with:</p>
            <div class="itemizedlist">
               <ul class="itemizedlist" style="list-style-type: none; ">
                  <li class="listitem" style="list-style-type: none">
                     <p>
                        <a id="para_b3741730-4d03-4950-b179-5fc32ac79cf4" shape="rect"></a>Ln referring to the natural logarithm</p>
                  </li>
                  <li class="listitem" style="list-style-type: none">
                     <p>
                        <a id="para_34966764-1dbb-49a6-aee1-f46fbf07c1e7" shape="rect"></a>j the index (1 to 1023) of the Luminance levels L<sub>j</sub> of the JNDs</p>
                  </li>
                  <li class="listitem" style="list-style-type: none">
                     <p>
                        <a id="para_ae16ed73-fd64-4f82-a5cc-15eb18d9f4f4" shape="rect"></a>a = -1.3011877</p>
                  </li>
                  <li class="listitem" style="list-style-type: none">
                     <p>
                        <a id="para_52ebe794-fa25-4f5b-9659-ea9397da67e2" shape="rect"></a>b = -2.5840191E-2</p>
                  </li>
                  <li class="listitem" style="list-style-type: none">
                     <p>
                        <a id="para_1f69ab0d-df81-4d33-8c4a-6447ca72429f" shape="rect"></a>c = 8.0242636E-2</p>
                  </li>
                  <li class="listitem" style="list-style-type: none">
                     <p>
                        <a id="para_ea681c23-2dc4-49a8-a48e-f69aa7bbd651" shape="rect"></a>d = -1.0320229E-1</p>
                  </li>
                  <li class="listitem" style="list-style-type: none">
                     <p>
                        <a id="para_46507035-94f9-4465-b199-d2004fbba163" shape="rect"></a>e = 1.3646699E-1</p>
                  </li>
                  <li class="listitem" style="list-style-type: none">
                     <p>
                        <a id="para_f70d263c-ef4f-4a51-aa9b-3896acefc8a2" shape="rect"></a>f = 2.8745620E-2</p>
                  </li>
                  <li class="listitem" style="list-style-type: none">
                     <p>
                        <a id="para_dcc20ea3-af91-46ec-85d6-a3d1fe24183a" shape="rect"></a>g = -2.5468404E-2</p>
                  </li>
                  <li class="listitem" style="list-style-type: none">
                     <p>
                        <a id="para_8bef1541-d6ab-427d-9194-e03336acb5ff" shape="rect"></a>h = -3.1978977E-3</p>
                  </li>
                  <li class="listitem" style="list-style-type: none">
                     <p>
                        <a id="para_fb1adb20-a1a5-4044-bc8e-36739a1dc6db" shape="rect"></a>k = 1.2992634E-4</p>
                  </li>
                  <li class="listitem" style="list-style-type: none">
                     <p>
                        <a id="para_bbed5b39-3f2c-44a7-a079-c57c418ea3c3" shape="rect"></a>m = 1.3635334E-3</p>
                  </li>
               </ul>
            </div>
            <p>
               <a id="para_dfd6c09f-7fe9-4cf1-b1c2-5ede83cc28cc" shape="rect"></a>The logarithms to the base 10 of the Luminance L<sub>j</sub> are very well interpolated by this function over the entire Luminance Range. The relative deviation of any log(Luminance) -value from the function is at most 0.3%, and the root-mean-square-error is 0.0003. The continuous representation of the Grayscale Standard Display Function permits a user to compute discrete JNDs for arbitrary start levels and over any desired Luminance Range.</p>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
               <h3 class="title">Note</h3>
               <div class="orderedlist">
                  <ol class="orderedlist" type="1">
                     <li class="listitem">
                        <p>
                           <a id="para_9d84a0a0-34ea-4b65-8c09-20376b52c016" shape="rect"></a>To apply <a class="xref" href="chapter_7.html#equation_7-1" title="Equation 7-1. " shape="rect">Equation 7-1</a> to a device with a specific range of L values, it is convenient to also have the inverse of this relationship, which is given by:
          
              </p>
                        <p>
                           <a id="para_4380a893-a15d-4780-8340-2672d2ff732d" shape="rect"></a>
                        </p>
                        <div class="equation">
                           <a id="equation_7-2" shape="rect"></a>
                           <p class="title">
                              <strong>Equation 7-2. </strong>
                           </p>
                           <div class="equation-contents">
                              <object type="image/svg+xml" data="figures/chapter_7_image_2.svg" style="">
                                 <param name="src" value="image_2.svg" />
                              </object>
                           </div>
                        </div>
                        <p>
                           <br class="equation-break" clear="none" />
                        </p>
                        <p>
                           <a id="para_975d7453-e4d7-4045-8497-b2b0c507c4a3" shape="rect"></a>where:</p>
                        <div class="itemizedlist">
                           <ul class="itemizedlist" style="list-style-type: none; ">
                              <li class="listitem" style="list-style-type: none">
                                 <p>
                                    <a id="para_079ab480-66ed-4ad1-a62e-dbca137a9abc" shape="rect"></a>Log<sub>10</sub> represents logarithm to the base 10</p>
                              </li>
                              <li class="listitem" style="list-style-type: none">
                                 <p>
                                    <a id="para_e455949c-7f36-499c-b533-d7c4ac23cdef" shape="rect"></a>A = 71.498068</p>
                              </li>
                              <li class="listitem" style="list-style-type: none">
                                 <p>
                                    <a id="para_4c2aeb52-55d9-48b0-9e7b-978b3e4dc239" shape="rect"></a>B = 94.593053</p>
                              </li>
                              <li class="listitem" style="list-style-type: none">
                                 <p>
                                    <a id="para_3b879ac6-1379-430a-9955-fcdaa1751e96" shape="rect"></a>C = 41.912053</p>
                              </li>
                              <li class="listitem" style="list-style-type: none">
                                 <p>
                                    <a id="para_704c5b63-328e-4b29-808d-7eb51bf3d68d" shape="rect"></a>D = 9.8247004</p>
                              </li>
                              <li class="listitem" style="list-style-type: none">
                                 <p>
                                    <a id="para_d2e80670-698b-4acb-b970-76e344f748ca" shape="rect"></a>E = 0.28175407</p>
                              </li>
                              <li class="listitem" style="list-style-type: none">
                                 <p>
                                    <a id="para_643d76f5-48c6-498e-8cb1-8f23d6881d75" shape="rect"></a>F = -1.1878455</p>
                              </li>
                              <li class="listitem" style="list-style-type: none">
                                 <p>
                                    <a id="para_c2868a6e-bd0f-4dfd-be2d-e97ef58b91e1" shape="rect"></a>G = -0.18014349</p>
                              </li>
                              <li class="listitem" style="list-style-type: none">
                                 <p>
                                    <a id="para_4b103419-0b0c-45b4-acfa-1d36febefbc9" shape="rect"></a>H = 0.14710899</p>
                              </li>
                              <li class="listitem" style="list-style-type: none">
                                 <p>
                                    <a id="para_6f6a46dd-3b9c-4414-bc53-4c33236aa400" shape="rect"></a>I = - 0.017046845</p>
                              </li>
                           </ul>
                        </div>
                     </li>
                     <li class="listitem">
                        <p>
                           <a id="para_c7afd76b-3ff0-46d5-8b1c-e8d58d2157ff" shape="rect"></a>When incorporating the formulas for L(j) and j(L) into a computer program, the use of double precision is recommended.</p>
                     </li>
                     <li class="listitem">
                        <p>
                           <a id="para_8f1f31df-9acd-42c1-9088-1001d9902f59" shape="rect"></a>Alternative methods may be used to calculate the JND Index values. One method is use a numerical algorithm such as the van Wijngaarden-Dekker-Brent method described in
        <span class="italic">Numerical Recipes in C</span>(Cambridge University press, 1991). The value j may be calculated from L iteratively given the Grayscale Standard Display Function's formula for L(j). Another method would be to use the Grayscale Standard Display Function's tabulated values of j and L to calculate the j corresponding to an arbitrary L by linearly interpolating between the two nearest tabulated L,j pairs.</p>
                     </li>
                     <li class="listitem">
                        <p>
                           <a id="para_362420e2-e7f0-435d-af11-91acfe70d070" shape="rect"></a>No specification is intended as to how these formulas are implemented. These could be implemented dynamically, by executing the equation directly, or through discrete values, such as a LUT, etc.</p>
                     </li>
                  </ol>
               </div>
            </div>
            <p>
               <a id="para_001c6b63-e551-484c-9f2e-3fada4e21b3d" shape="rect"></a>
               <a class="xref" href="chapter_B.html" title="B Table of the Grayscale Standard Display Function (Informative)" shape="rect">Annex B</a> lists the Luminance levels computed with this equation for the 1023 integer JND Indices and <a class="xref" href="chapter_8.html#figure_7-1" title="Figure 7-1. The Grayscale Standard Display Function presented as logarithm-of-Luminance versus JND-Index" shape="rect">Figure 7-1</a> shows a plot of the Grayscale Standard Display Function. The exact value of the Luminance levels, of course, depends on the start level of 0.05 cd/m
  <sup>2</sup>.</p>
            <p>
               <a id="para_a51e9e8a-5767-4cd3-839b-e294db2f3cc4" shape="rect"></a>The Characteristic Curve of a Display System represents the Luminance produced by a Display System as a function of DDL and the effect of ambient Illuminance. The Characteristic Curve is measured with Standard Test Patterns (see <a class="xref" href="chapter_D.html" title="D Illustrations for Achieving Conformance with the Grayscale Standard Display Function (Informative)" shape="rect">Annex D</a>). In general, the Display Function describes, for example,</p>
            <div class="orderedlist">
               <ol class="orderedlist" type="a">
                  <li class="listitem">
                     <p>
                        <a id="para_ef5f488d-96ff-4fc4-8b1d-6840350aef23" shape="rect"></a>the Luminance (including ambient Illuminance) measured as a function of DDL for emissive displays such as a CRT-monitor/digital display controller system,</p>
                  </li>
                  <li class="listitem">
                     <p>
                        <a id="para_7a8466bb-bfe0-4ecc-a36e-ba1a44c37cee" shape="rect"></a>the Luminance (including ambient Illuminance) as a function of DDL measured for a transmissive medium hung in front of a light-box after a printer produced an optical density, depending on DDL, on the medium,</p>
                  </li>
                  <li class="listitem">
                     <p>
                        <a id="para_9d0e0333-e525-45e4-80b6-bb3136a0d63a" shape="rect"></a>the Luminance (including ambient light) as a function of DDL measured for a diffusely reflective medium illuminated by a office lights after a printer produced a reflective density, depending on DDL, on the medium.</p>
                  </li>
               </ol>
            </div>
            <p>
               <a id="para_996a6c51-b770-498f-8573-f7eedf776408" shape="rect"></a>By internal or external means, the system may have been configured (or calibrated) such that the Characteristic Curve is consistent with the Grayscale Standard Display Function.</p>
            <p>
               <a id="para_c4f3579c-879b-40e0-a0b6-bba2b93dd320" shape="rect"></a>Some Display Systems adapt themselves to ambient light conditions. Such a system may conform to the Grayscale Standard Display Function for one level of ambient Illuminance only, unless it had the capability of adjusting its Display Function without user-intervention so that it remains in conformance with the Grayscale Standard Display Function.</p>
         </div>
      </div>
      <div class="navfooter">
         <hr />
         <table width="100%" summary="Navigation footer">
            <tr>
               <td width="40%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="chapter_6.html" shape="rect">Prev</a> </td>
               <td width="20%" align="center" rowspan="1" colspan="1"> </td>
               <td width="40%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="sect_7.2.html" shape="rect">Next</a>
               </td>
            </tr>
            <tr>
               <td width="40%" align="left" valign="top" rowspan="1" colspan="1">6 Overview </td>
               <td width="20%" align="center" rowspan="1" colspan="1">
                  <a accesskey="h" href="PS3.14.html" shape="rect">Home</a>
               </td>
               <td width="40%" align="right" valign="top" rowspan="1" colspan="1"> 7.2 Transmissive Hardcopy Printers</td>
            </tr>
         </table>
      </div>
      <table xmlns="" xmlns:d="http://docbook.org/ns/docbook" width="100%">
         <tr>
            <th colspan="1" align="center" rowspan="1">
               <span class="documentreleaseinformation">DICOM PS3.14 - Grayscale Standard Display Function</span>
            </th>
         </tr>
      </table>
   </body>
</html>
