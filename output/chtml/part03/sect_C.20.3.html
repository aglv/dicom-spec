<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>C.20.3 Deformable Spatial Registration Module</title>
      <link rel="stylesheet" type="text/css" href="dicom.css" />
      <meta name="generator" content="DocBook XSL Stylesheets V1.78.1" />
      <link rel="home" href="PS3.3.html" title="PS3.3" />
      <link rel="up" href="sect_C.20.html" title="C.20 Spatial Registration" />
      <link rel="prev" href="sect_C.20.2.html" title="C.20.2 Spatial Registration Module" />
      <link rel="next" href="sect_C.21.html" title="C.21 Spatial Fiducials" />
      <style type="text/css"><![CDATA[
	p { font-size: 15px; }
      ]]></style>
   </head>
   <body>
      <table xmlns="" xmlns:d="http://docbook.org/ns/docbook" width="100%">
         <tr>
            <th colspan="1" align="center" rowspan="1">
               <span class="documentreleaseinformation">DICOM PS3.3 2024b - Information Object Definitions</span>
            </th>
         </tr>
      </table>
      <div xmlns="" class="navheader">
         <table width="100%" summary="Navigation header">
            <tr>
               <th colspan="3" align="center" rowspan="1">C.20.3 Deformable Spatial Registration Module <a accesskey="current" href="http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.20.3.html" shape="rect">(Current)</a>
               </th>
            </tr>
            <tr>
               <td width="20%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="sect_C.20.2.html" shape="rect">Prev</a> </td>
               <th width="60%" align="center" rowspan="1" colspan="1">C.20 Spatial Registration</th>
               <td width="20%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="sect_C.21.html" shape="rect">Next</a>
               </td>
            </tr>
         </table>
         <hr />
      </div>
      <div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="breadcrumbs">
         <span class="breadcrumb-link">
            <a href="PS3.3.html" shape="rect">PS3.3</a>
         </span> &gt; <span class="breadcrumb-link">
            <a href="chapter_C.html" shape="rect">Information Module Definitions (Normative)</a>
         </span> &gt; <span class="breadcrumb-link">
            <a href="sect_C.20.html" shape="rect">Spatial Registration</a>
         </span> &gt; <span class="breadcrumb-node">Deformable Spatial Registration Module</span>
      </div>
      <div class="section">
         <div class="titlepage">
            <div>
               <div>
                  <h3 class="title">
                     <a id="sect_C.20.3" shape="rect"></a>C.20.3 Deformable Spatial Registration Module</h3>
               </div>
            </div>
         </div>
         <p>
            <a id="para_7aa6e1c5-b7ad-45ce-8163-5ea718919191" shape="rect"></a>
                    <a class="xref" href="sect_C.20.3.html#table_C.20.3-1" title="Table C.20.3-1. Deformable Spatial Registration Module Attributes" shape="rect">Table C.20.3-1</a> specifies the Attributes of the <a class="xref" href="sect_C.20.3.html" title="C.20.3 Deformable Spatial Registration Module" shape="rect">Deformable Spatial Registration Module</a>.</p>
         <div class="table">
            <a id="table_C.20.3-1" shape="rect"></a>
            <p class="title">
               <strong>Table C.20.3-1. Deformable Spatial Registration Module Attributes</strong>
            </p>
            <div class="table-contents">
               <table frame="box" rules="all">
                  <thead>
                     <tr valign="top">
                        <th align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_6316b5a5-3ec4-4b35-9b1e-ffdd6910564f" shape="rect"></a>Attribute Name</p>
                            </th>
                        <th align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_89c2c1a0-d1e4-447e-bb6b-95216f7be46d" shape="rect"></a>Tag</p>
                            </th>
                        <th align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_4dea152a-6af9-407c-8ca5-5bbc840937fd" shape="rect"></a>Type</p>
                            </th>
                        <th align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_95dd7810-717c-4113-9c02-77136812bd99" shape="rect"></a>Attribute Description</p>
                            </th>
                     </tr>
                  </thead>
                  <tbody>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_27ad286d-8f86-45ed-b2a0-d11b297837c3" shape="rect"></a>Content Date</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_a40abab0-a957-49c2-99be-19d54e9caa43" shape="rect"></a>(0008,0023)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_da2edbc7-1390-4ca3-b31c-bf37ac41fb38" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_4eab7a58-c754-4441-9966-8ba20310fadc" shape="rect"></a>The date the vector grid data creation started.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_bb5e6a8f-4f55-4bb1-9cd5-9989c08ae66b" shape="rect"></a>Content Time</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_23dc1b02-ed1f-478f-9ed7-872e60d600cd" shape="rect"></a>(0008,0033)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_5bca3eea-7eb4-418c-921e-207c8b1785dd" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_c55ef906-983e-4697-bec4-49a6596cf36b" shape="rect"></a>The time the vector grid data creation started.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" colspan="4" rowspan="1">
                                <p>
                              <a id="para_acf638a2-0666-4e9b-be8f-ca50f19387dc" shape="rect"></a>
                                    <span class="italic">Include <a class="xref" href="sect_10.9.html#table_10-12" title="Table 10-12. Content Identification Macro Attributes" shape="rect">Table 10-12 “Content Identification Macro Attributes”</a>
                                    </span>
                                </p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_ed367167-e912-4936-a2ea-2f21f650917c" shape="rect"></a>Deformable Registration Sequence</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_cd4761b3-ddb5-4cab-a6a4-57c9320ca001" shape="rect"></a>(0064,0002)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_520993d9-11d7-4306-8433-ff416732b91d" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_f72da294-99d7-4b75-bd34-63824d883849" shape="rect"></a>A Sequence of registration Items. Each Item defines a spatial registration to the referenced images in that Item. At least one Item shall have a Deformable Registration Grid Sequence (0064,0005) with one Item. See <a class="xref" href="sect_C.20.3.html#sect_C.20.3.1.1" title="C.20.3.1.1 Deformable Registration Sequence Application" shape="rect">Section C.20.3.1.1</a>.</p>
                                <p>
                              <a id="para_6dbba1a7-ae6e-4808-9634-4d87977a17c4" shape="rect"></a>One or more Items shall be included in this Sequence.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_0172ad70-4ab9-4b1c-b6c5-89893bfb1c4c" shape="rect"></a>&gt;Source Frame of Reference UID</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_5340756b-4377-4b07-938a-82e53c1ac693" shape="rect"></a>(0064,0003)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_30028e5e-2568-49c7-8fbc-e01b4925d427" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_1bee1636-1880-4ce8-be74-598067d3adb7" shape="rect"></a>Identifies the Frame of Reference of a Source RCS. The Source RCS may or may not include an image set (e.g., atlas). See <a class="xref" href="sect_C.7.4.html#sect_C.7.4.1.1.1" title="C.7.4.1.1.1 Frame of Reference UID" shape="rect">Section C.7.4.1.1.1</a> for further explanation.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_ab5a079f-57fe-4655-b6a7-b7da588fafd9" shape="rect"></a>&gt;Referenced Image Sequence</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_c362305e-4ef0-4f0e-aded-a3411e9b6650" shape="rect"></a>(0008,1140)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_ca53953e-4412-4fd6-adba-ec70bfc0bb91" shape="rect"></a>1C</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_31c1be38-b564-4070-8b35-8486d7bbd071" shape="rect"></a>Identifies the set of images registered in this Item.</p>
                                <p>
                              <a id="para_2fb2b6c8-44f8-40f5-a03a-0f35ebad6efd" shape="rect"></a>One or more Items shall be included in this Sequence.</p>
                                <p>
                              <a id="para_4edbc858-c82c-4d98-9802-e40f8d49acd2" shape="rect"></a>Required if the registration applies to a subset of images within the specified Source Frame of Reference UID (0064,0003). All referenced images shall be in the same spatial Frame of Reference.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" colspan="4" rowspan="1">
                                <p>
                              <a id="para_72d3ef45-3888-4e06-87f8-ca7ec18ea5f7" shape="rect"></a>
                                    <span class="italic">&gt;&gt;Include <a class="xref" href="sect_10.3.html#table_10-3" title="Table 10-3. Image SOP Instance Reference Macro Attributes" shape="rect">Table 10-3 “Image SOP Instance Reference Macro Attributes”</a>
                                    </span>
                                </p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_3605bc9e-4fba-4bce-9b7b-f4a43330b433" shape="rect"></a>&gt;Frame of Reference Transformation Comment</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_86a61411-157b-4ff4-a800-3102baea8b72" shape="rect"></a>(3006,00C8)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_2b15f40c-800d-4e00-ab54-07f9af13b944" shape="rect"></a>3</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_2283f41e-f324-4386-8ebc-9cc682565eb4" shape="rect"></a>User description or comments about the registration.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_f988c726-42f9-4d23-8d9b-ff1b1d838f64" shape="rect"></a>&gt;Registration Type Code Sequence</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_0a69bbbc-c15a-4623-9a43-46979809b401" shape="rect"></a>(0070,030D)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_2749b588-66bd-409d-94ef-386d6207580e" shape="rect"></a>2</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_865b6b3c-f4f2-40c8-af31-406deef6e596" shape="rect"></a>Describes the method used for the registration process.</p>
                                <p>
                              <a id="para_c26c6e1e-1e39-4570-9f83-dfff3d2e1665" shape="rect"></a>Zero or one Item shall be included in this Sequence.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" colspan="3" rowspan="1">
                                <p>
                              <a id="para_fddce60c-48fc-4597-ba8f-8fadd9f076a3" shape="rect"></a>
                                    <span class="italic">&gt;&gt;Include <a class="xref" href="sect_8.8.html#table_8.8-1" title="Table 8.8-1. Code Sequence Macro Attributes" shape="rect">Table 8.8-1 “Code Sequence Macro Attributes”</a>
                                    </span>
                                </p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_eae04983-f63b-4254-a4f9-be079d23637f" shape="rect"></a>
                                    <span class="italic">B<a href="../part16/sect_CID_7100.html" class="olink" shape="rect">CID 7100 “RCS Registration Method Type”</a>.</span>
                                </p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_f8ee8b33-d321-4b96-9f57-dcfac30444b6" shape="rect"></a>&gt;Pre Deformation Matrix Registration Sequence</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_4c1297e0-cbaa-4323-8ed6-b6dca9a3b797" shape="rect"></a>(0064,000F)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_123698da-a434-407e-b367-8f259d3f3d8e" shape="rect"></a>1C</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_edfccb14-ba1e-44f4-9606-bddf4c63ed1c" shape="rect"></a>A Sequence that specifies one spatial registration to be applied prior to the deformation.</p>
                                <p>
                              <a id="para_a6bda795-4559-4b4c-8fde-5f5c38486f11" shape="rect"></a>Only a single Item shall be included in this Sequence.</p>
                                <p>
                              <a id="para_47d5f1c3-ed8f-4abb-8cbc-96a7538b9ad1" shape="rect"></a>Required if a matrix transformation is to be applied prior to deformation.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_99d2536d-37c1-43a6-975c-639cc85442b0" shape="rect"></a>&gt;&gt;Frame of Reference Transformation Matrix</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_bf1b44f2-b19d-4f4d-ac9e-c0f82e7919f2" shape="rect"></a>(3006,00C6)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_0a845a8d-79a4-4906-998f-0cdab0be3ecf" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_424885dd-b9f2-40bb-82ec-98be3f50691a" shape="rect"></a>A 4x4 homogeneous transformation matrix. Matrix elements shall be listed in row-major order. See <a class="xref" href="sect_C.20.2.html#sect_C.20.2.1.1" title="C.20.2.1.1 Frame of Reference Transformation Matrix" shape="rect">Section C.20.2.1.1</a>.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_1424a0b8-36d3-4911-b9eb-30bc5a2d0895" shape="rect"></a>&gt;&gt;Frame of Reference Transformation Matrix Type</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_dafc54e7-c8ba-43cd-9f4e-6ff8e4a4932d" shape="rect"></a>(0070,030C)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_b850ddea-7117-4a82-aa00-4eb44cabd59a" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_958b1507-01e6-415c-8975-4e3ebd54279f" shape="rect"></a>Type of Frame of Reference Transformation Matrix (3006,00C6).</p>
                                <div class="variablelist">
                              <p class="title">
                                 <strong>Enumerated Values:</strong>
                              </p>
                              <dl class="variablelist compact">
                                 <dt>
                                    <span class="term">RIGID</span>
                                 </dt>
                                 <dd>
                                    <p>
                                       <a id="para_5a6b5b8c-2810-46d4-a140-a9da15c91c13" shape="rect"></a>
                                    </p>
                                 </dd>
                                 <dt>
                                    <span class="term">RIGID_SCALE</span>
                                 </dt>
                                 <dd>
                                    <p>
                                       <a id="para_5ac08728-b700-4197-af6f-9acc1c884ebf" shape="rect"></a>
                                    </p>
                                 </dd>
                                 <dt>
                                    <span class="term">AFFINE</span>
                                 </dt>
                                 <dd>
                                    <p>
                                       <a id="para_0a71a306-8eee-4cd9-9b1f-dae77d500588" shape="rect"></a>
                                    </p>
                                 </dd>
                              </dl>
                           </div>
                                <p>
                              <a id="para_159e73fc-ea74-42b7-a4dc-e80f25d46ccf" shape="rect"></a>See <a class="xref" href="sect_C.20.2.html#sect_C.20.2.1.2" title="C.20.2.1.2 Frame of Reference Transformation Matrix Type" shape="rect">Section C.20.2.1.2</a>
                                </p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_a6f233ec-5ce8-4155-93fe-b5dcb56f22bd" shape="rect"></a>&gt;Post Deformation Matrix Registration Sequence</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_195e77a8-bb99-4e94-a892-61c0232fd1de" shape="rect"></a>(0064,0010)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_4bd90e20-15e4-435d-bf99-d67f1026a7c8" shape="rect"></a>1C</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_477135d6-7c42-485f-a32e-b32ff781236e" shape="rect"></a>A Sequence that specifies one spatial registration to be applied after the application of the deformation.</p>
                                <p>
                              <a id="para_c2a8d7f8-9e39-4715-b460-4cc8d59b70da" shape="rect"></a>Only a single Item shall be included in this Sequence.</p>
                                <p>
                              <a id="para_e363ef9d-917b-4f07-b56f-9581ef89aff3" shape="rect"></a>Required if matrix transformation is to be performed after application of the deformation.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_480bf5c9-2346-4ff5-b672-37b73f6be02d" shape="rect"></a>&gt;&gt;Frame of Reference Transformation Matrix</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_b9d9398c-bdd9-4df0-ac95-17bf50c859fb" shape="rect"></a>(3006,00C6)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_7b7dcb2a-28f2-4804-8595-c97655cd4d34" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_e5855a3d-f24c-4b26-b968-08a0ca7be531" shape="rect"></a>A 4x4 homogeneous transformation matrix. Matrix elements shall be listed in row-major order. See <a class="xref" href="sect_C.20.2.html#sect_C.20.2.1.1" title="C.20.2.1.1 Frame of Reference Transformation Matrix" shape="rect">Section C.20.2.1.1</a>.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_dd238959-8059-4304-9313-8b4cee3215cf" shape="rect"></a>&gt;&gt;Frame of Reference Transformation Matrix Type</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_4bd0318d-c67c-4588-a5c0-0dbb17044d52" shape="rect"></a>(0070,030C)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_18f84860-b1d8-45c9-a511-7556fee91865" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_053173d1-af2b-4ed9-b256-72f6e6a99a86" shape="rect"></a>Type of Frame of Reference Transformation Matrix (3006,00C6).</p>
                                <div class="variablelist">
                              <p class="title">
                                 <strong>Defined Terms:</strong>
                              </p>
                              <dl class="variablelist compact">
                                 <dt>
                                    <span class="term">RIGID</span>
                                 </dt>
                                 <dd>
                                    <p>
                                       <a id="para_bf50f9bf-eb6c-427e-a377-544366c65301" shape="rect"></a>
                                    </p>
                                 </dd>
                                 <dt>
                                    <span class="term">RIGID_SCALE</span>
                                 </dt>
                                 <dd>
                                    <p>
                                       <a id="para_f5723ea2-9be1-4407-af41-d7f3176aa4f1" shape="rect"></a>
                                    </p>
                                 </dd>
                                 <dt>
                                    <span class="term">AFFINE</span>
                                 </dt>
                                 <dd>
                                    <p>
                                       <a id="para_47abad5f-dc73-4f4d-9a9e-4a3f95d0fe16" shape="rect"></a>
                                    </p>
                                 </dd>
                              </dl>
                           </div>
                                <p>
                              <a id="para_374ecfda-d7f4-41f3-b9a9-c795dcb683a1" shape="rect"></a>See <a class="xref" href="sect_C.20.2.html#sect_C.20.2.1.2" title="C.20.2.1.2 Frame of Reference Transformation Matrix Type" shape="rect">Section C.20.2.1.2</a>
                                </p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_8d94ddcf-0ff8-4d0f-a636-eeaaef19db0d" shape="rect"></a>&gt;Deformable Registration Grid Sequence</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_0cb5e72b-b569-4bdd-ac96-324ed9e83c17" shape="rect"></a>(0064,0005)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_1721e4fb-f57d-447c-b7d6-921c02cdeede" shape="rect"></a>1C</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_fab5abb7-ad95-4abb-827e-93caaeab11a9" shape="rect"></a>Describes the deformation grid used to sample into the Source RCS.</p>
                                <p>
                              <a id="para_69cf3d3c-1f6f-4d06-82d9-2662038ddd67" shape="rect"></a>Only a single Item shall be included in this Sequence.</p>
                                <p>
                              <a id="para_f37cc19a-5822-427f-9550-da8281b12f2a" shape="rect"></a>Required if deformation is performed. See <a class="xref" href="sect_C.20.3.html#sect_C.20.3.1.2" title="C.20.3.1.2 Deformable Registration Grid Sequence" shape="rect">Section C.20.3.1.2</a>.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_db7d13ed-eac6-4ee5-b965-df08d9ba1c85" shape="rect"></a>&gt;&gt;Image Orientation (Patient)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_0990d073-d8ac-4557-839b-f9aef4cdae99" shape="rect"></a>(0020,0037)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_eaaca042-b3f6-46b1-b03c-1d1ac24e1e1b" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_6aea67e4-bf36-4b21-b26b-19147184841c" shape="rect"></a>The direction of cosines of the first row and first column of the Vector Grid Data (0064,0009) with respect to the patient. See <a class="xref" href="sect_C.7.6.2.html#sect_C.7.6.2.1.1" title="C.7.6.2.1.1 Image Position and Image Orientation" shape="rect">Section C.7.6.2.1.1</a> for further explanation.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_ef300e6d-9388-45f2-ba92-67f93f1d248b" shape="rect"></a>&gt;&gt;Image Position (Patient)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_aebc7d6d-56a9-4c17-bfe3-876e0d4ecdd6" shape="rect"></a>(0020,0032)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_e12c3432-c0d5-42f3-88d3-1bd4d66ac05c" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_573ffdd9-3dbb-4159-87d4-f320a87c5e6e" shape="rect"></a>The x, y, and z coordinates of the upper left hand voxel (center of the first voxel transmitted) of the grid, in mm in the Registered Frame of Reference. See <a class="xref" href="sect_C.7.6.2.html#sect_C.7.6.2.1.1" title="C.7.6.2.1.1 Image Position and Image Orientation" shape="rect">Section C.7.6.2.1.1</a> for further explanation.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_7dd563f8-a155-4bf0-aa67-8c1f2efb9f65" shape="rect"></a>&gt;&gt;Grid Dimensions</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_0daee980-30ea-4d02-8626-6fe8074f4557" shape="rect"></a>(0064,0007)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_f39e93ce-8d34-42d5-8c44-f0368afc5ae6" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_9a8fd6ee-5ffd-4481-87b7-9d845a58c3ee" shape="rect"></a>The dimensions of the grid, in voxels. A triple representing the number of voxels along the X, Y, and Z axes.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_47ec6a5a-5372-4288-90df-d2069a77b94b" shape="rect"></a>&gt;&gt;Grid Resolution</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_1385cdd9-9dee-4105-8c1e-b4cee0438d0f" shape="rect"></a>(0064,0008)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_c9d56d0e-f1a9-4c0d-a02a-5079b48708c3" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_136fcd8f-fbb5-4618-bbe6-321111ec8891" shape="rect"></a>The resolution of the grid voxels. A triple representing the size of a deformation voxel in along the X, Y, and Z dimension, in mm.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_ccee7a2e-04cf-4175-bd11-a148c2b3b391" shape="rect"></a>&gt;&gt;Vector Grid Data</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_46d8aaf3-770a-4b09-9971-eef07443d75c" shape="rect"></a>(0064,0009)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_fe4faad0-f5aa-4e4a-a550-fbda9f8fd536" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_6b04865a-99e3-4480-9245-a18ee619331f" shape="rect"></a>A data stream of vectors describing the direction and magnitude of the deformation in mm. See <a class="xref" href="sect_C.20.3.html#sect_C.20.3.1.3" title="C.20.3.1.3 Vector Grid Data" shape="rect">Section C.20.3.1.3</a> for further explanation.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_b247cf64-dfe1-46a5-9c4c-6ca4ce23a4ce" shape="rect"></a>&gt;Used Fiducials Sequence</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_2afba8b4-02ff-4bfc-8c5a-165634f03db1" shape="rect"></a>(0070,0314)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_e85d63c7-7d96-4dc1-bae6-8a92a0ba47d5" shape="rect"></a>3</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_9becce32-b382-4b70-b09f-57c96eeb03d2" shape="rect"></a>The fiducials used to determine the registration.</p>
                                <p>
                              <a id="para_d1b69085-1c53-4da4-a125-6998cde9f638" shape="rect"></a>One or more Items are permitted in this Sequence.</p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" colspan="3" rowspan="1">
                                <p>
                              <a id="para_dbf78c20-4f79-4c1d-953f-363a3383eb0f" shape="rect"></a>
                                    <span class="italic">&gt;&gt;Include <a class="xref" href="sect_10.8.html#table_10-11" title="Table 10-11. SOP Instance Reference Macro Attributes" shape="rect">Table 10-11 “SOP Instance Reference Macro Attributes”</a>
                                    </span>
                                </p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_c1c83123-e365-4108-a688-2ac50aeb07fd" shape="rect"></a>
                              <span class="italic">Reference to the Spatial Fiducial SOP Instance identifying the used Fiducial(s).</span>
                           </p>
                            </td>
                     </tr>
                     <tr valign="top">
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_9cfab6c1-e1f6-4f74-8cce-ecc5ca9cf718" shape="rect"></a>&gt;&gt;Fiducial UID</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_d174e9f1-e694-41bc-9aa9-4b8c3931d84b" shape="rect"></a>(0070,031A)</p>
                            </td>
                        <td align="center" rowspan="1" colspan="1">
                                <p>
                              <a id="para_62260880-4239-4320-862d-fb4c8836184a" shape="rect"></a>1</p>
                            </td>
                        <td align="left" rowspan="1" colspan="1">
                                <p>
                              <a id="para_69dff0e0-a7db-4def-830a-865bd27bc344" shape="rect"></a>The UID that identifies the fiducial used as registration input.</p>
                            </td>
                     </tr>
                  </tbody>
               </table>
            </div>
         </div>
         <br class="table-break" clear="none" />
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h4 class="title">
                        <a id="sect_C.20.3.1" shape="rect"></a>C.20.3.1 Deformable Spatial Registration Module Attribute Descriptions</h4>
                  </div>
               </div>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h5 class="title">
                           <a id="sect_C.20.3.1.1" shape="rect"></a>C.20.3.1.1 Deformable Registration Sequence Application</h5>
                     </div>
                  </div>
               </div>
               <p>
                  <a id="para_1a13f7eb-b316-4143-b616-69d80111ef0d" shape="rect"></a>The registrations in this Module are applied to the Registered RCS coordinates in the following order. First, transform the coordinates using the matrix described in the Pre Deformation Matrix Registration Sequence (0064,000F). Next apply the deformation offsets to the resulting coordinates. Finally, transform those coordinates using the matrix described in the Post Deformation Matrix Registration Sequence (0064,0010). The resulting coordinate addresses the sample point within the Source RCS.</p>
               <p>
                  <a id="para_f173e8ce-6e62-4ff3-92c4-0e2de7cb9507" shape="rect"></a>Thus a source coordinate may be calculated using <a class="xref" href="sect_C.20.3.html#equation_C.20.3-1" title="Equation C.20.3-1. " shape="rect">Equation C.20.3-1</a> (this assumes that the center position of each deformation voxel will be transformed).</p>
               <p>
                  <a id="para_429a807d-673e-45f5-834b-9ac527d913ac" shape="rect"></a>
                            </p>
               <div class="equation">
                  <a id="equation_C.20.3-1" shape="rect"></a>
                  <p class="title">
                     <strong>Equation C.20.3-1. </strong>
                  </p>
                  <div class="equation-contents">
                     <object type="image/svg+xml" data="figures/sect_C.20.3_image_1.svg" style="">
                        <param name="src" value="image_1.svg" />
                     </object>
                  </div>
               </div>
               <p>
                  <br class="equation-break" clear="none" />
                        </p>
               <p>
                  <a id="para_ef6e818d-ffe0-44e6-95e6-8ea324274919" shape="rect"></a>Where:</p>
               <div class="informaltable">
                  <table frame="void" rules="none">
                     <tbody>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_edaaf4c7-6a5f-4c3c-ac7e-a35e08ff0ba9" shape="rect"></a>
                                            </p>
                              <div class="informalequation">
                                 <object type="image/svg+xml" data="figures/sect_C.20.3_image_2.svg" style="position: relative; bottom: -6.743475px;">
                                    <param name="src" value="image_2.svg" />
                                 </object>
                              </div>
                              <p>
                                        </p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_70efc3a3-16bb-4579-ba13-5ddb04d8250a" shape="rect"></a>The spatial coordinate in the Source RCS.</p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_f7e3b7a8-186b-44b2-8634-1f7f0fb80375" shape="rect"></a>
                                            </p>
                              <div class="informalequation">
                                 <object type="image/svg+xml" data="figures/sect_C.20.3_image_3.svg" style="position: relative; bottom: -6.743475px;">
                                    <param name="src" value="image_3.svg" />
                                 </object>
                              </div>
                              <p>
                                        </p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_c3c1b6c2-937e-4659-8cdb-27cd9b713eab" shape="rect"></a>The start coordinate, in the Registered RCS, of the deformation grid as specified in Image Position (Patient) (0020,0032).</p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_eda13dfd-da85-4382-bee4-9ccf79cdf87c" shape="rect"></a>
                                            </p>
                              <div class="informalequation">
                                 <object type="image/svg+xml" data="figures/sect_C.20.3_image_4.svg" style="position: relative; bottom: -6.668924999999998px;">
                                    <param name="src" value="image_4.svg" />
                                 </object>
                              </div>
                              <p>
                                        </p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_61d954a6-023f-43f8-b2c7-da83213bb12c" shape="rect"></a>The values from the row (X) direction cosine of Image Orientation (Patient) (0020,0037).</p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_b4f8d417-289e-441b-9264-fb7a5c8c567b" shape="rect"></a>
                                            </p>
                              <div class="informalequation">
                                 <object type="image/svg+xml" data="figures/sect_C.20.3_image_5.svg" style="position: relative; bottom: -6.8286750000000005px;">
                                    <param name="src" value="image_5.svg" />
                                 </object>
                              </div>
                              <p>
                                        </p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_78b0910a-03a7-4377-b429-75c638ef67c8" shape="rect"></a>The values from the column (Y) direction cosine of Image Orientation (Patient) (0020,0037).</p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_b70f9656-e4e6-4ef7-9ca7-b8e1052eb259" shape="rect"></a>
                                            </p>
                              <div class="informalequation">
                                 <object type="image/svg+xml" data="figures/sect_C.20.3_image_6.svg" style="position: relative; bottom: -8.820225px;">
                                    <param name="src" value="image_6.svg" />
                                 </object>
                              </div>
                              <p>
                                        </p>
                                    </td>
                           <td align="left" rowspan="2" colspan="1">
                                        <p>
                                 <a id="para_dc73bece-d024-41fc-8117-470b225d4dbf" shape="rect"></a>The cross product between the row (X) direction cosine and the column (Y) direction cosine of Image Orientation (Patient) (0020,0037).</p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_d9b7aefc-660c-40f1-bd6f-55ea50c65e71" shape="rect"></a>
                                            </p>
                              <div class="informalequation">
                                 <object type="image/svg+xml" data="figures/sect_C.20.3_image_7.svg" style="position: relative; bottom: -8.820225px;">
                                    <param name="src" value="image_7.svg" />
                                 </object>
                              </div>
                              <p>
                                        </p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_6bc54157-209b-440a-8687-79a2fae635fd" shape="rect"></a>
                                            </p>
                              <div class="informalequation">
                                 <object type="image/svg+xml" data="figures/sect_C.20.3_image_8.svg" style="position: relative; bottom: -5.82px;">
                                    <param name="src" value="image_8.svg" />
                                 </object>
                              </div>
                              <p>
                                        </p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_6856bdb6-97ae-4946-b45c-78dbda3e56a0" shape="rect"></a>The index into the deformation grid in the X, Y, and Z dimension.</p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_8f9e02ce-b542-4b4b-a3a6-206134ee1dd0" shape="rect"></a>
                                            </p>
                              <div class="informalequation">
                                 <object type="image/svg+xml" data="figures/sect_C.20.3_image_9.svg" style="position: relative; bottom: -6.477225000000001px;">
                                    <param name="src" value="image_9.svg" />
                                 </object>
                              </div>
                              <p>
                                        </p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_177e2c7c-b9b6-4d31-9f2d-112644753479" shape="rect"></a>The resolution of the deformation grid in the X, Y, and Z dimension as specified in Grid Resolution (0064,0008).</p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_f8672e75-ad2c-4162-a414-17849731c314" shape="rect"></a>
                                            </p>
                              <div class="informalequation">
                                 <object type="image/svg+xml" data="figures/sect_C.20.3_image_10.svg" style="position: relative; bottom: -7.0757625px;">
                                    <param name="src" value="image_10.svg" />
                                 </object>
                              </div>
                              <p>
                                        </p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_5b6ed978-aa93-4f04-9d95-c36b694eb364" shape="rect"></a>The deformation specified at index (i,j,k) in the deformation grid. If the Deformation Registration Grid Sequence (0064,0005) has no Items, the D values are zero.</p>
                                    </td>
                        </tr>
                        <tr>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_dbf17621-5f90-492e-977d-0be7b582d3dc" shape="rect"></a>
                                            </p>
                              <div class="informalequation">
                                 <span class="mathphrase">M<sub>Pre</sub>
                                                </span>
                              </div>
                              <p>
                                        </p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_d7119914-604b-482e-8434-bb7a47b1f30e" shape="rect"></a>The transformation matrix specified in the Pre Deformation Matrix Registration Sequence (0064,000F).</p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <div class="informalequation">
                                 <span class="mathphrase">M<sub>Post</sub>
                                            </span>
                              </div>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_7e12e911-d491-4648-975a-5d711944999c" shape="rect"></a>The transformation matrix specified in the Post Deformation Matrix Registration Sequence (0064,0010).</p>
                                    </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h5 class="title">
                           <a id="sect_C.20.3.1.2" shape="rect"></a>C.20.3.1.2 Deformable Registration Grid Sequence</h5>
                     </div>
                  </div>
               </div>
               <p>
                  <a id="para_311cafa0-d95d-415f-8659-0e6a56d8f247" shape="rect"></a>The vector represents the deformation at the center of the voxel. Deformations between voxel centers shall be determined through interpolation of the surrounding vectors in an implementation dependent manner.</p>
            </div>
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h5 class="title">
                           <a id="sect_C.20.3.1.3" shape="rect"></a>C.20.3.1.3 Vector Grid Data</h5>
                     </div>
                  </div>
               </div>
               <p>
                  <a id="para_c075a9bb-8b52-482b-94e7-cbf52d6a90f4" shape="rect"></a>Vector Grid Data (0064,0009) contains the vector data. Each voxel in Vector Grid Data (0064,0009) is represented by an </p>
               <div class="informalequation">
                  <object type="image/svg+xml" data="figures/sect_C.20.3_image_11.svg" style="position: relative; bottom: -7.0757625px;">
                     <param name="src" value="image_11.svg" />
                  </object>
               </div>
               <p> vector. The vector describes the direction and magnitude of the deformation (in mm) at the center of the deformation voxel.</p>
               <p>
                  <a id="para_48a60bc4-3e47-417d-a9b9-f6146fab73fe" shape="rect"></a>The order of vectors encoded for each vector plane shall be left to right, top to bottom, i.e., the upper left vector (labeled 1,1) is encoded first followed by the remainder of row 1, followed by the first vector of row 2 (labeled 2,1) then the remainder of row 2 and so on.</p>
               <p>
                  <a id="para_01acb69e-b7fa-4491-9853-84651efe373f" shape="rect"></a>A vector triple with values of (NaN,NaN,NaN) shall indicate that the transformation at that point of the deformation grid is undefined.</p>
               <p>
                  <a id="para_e3491563-1c12-45a9-8d05-b466b43472b3" shape="rect"></a>The size of this Attribute value is determined by the dimensions specified in Grid Dimensions (0064,0007). For dimensions of X<sub>D</sub>\Y<sub>D</sub>\Z<sub>D</sub>, the size of the Attribute value can be calculated with <a class="xref" href="sect_C.20.3.html#equation_C.20.3-2" title="Equation C.20.3-2. " shape="rect">Equation C.20.3-2</a>.</p>
               <p>
                  <a id="para_9b04df04-467e-4343-9756-750bfd0d1baf" shape="rect"></a>
                            </p>
               <div class="equation">
                  <a id="equation_C.20.3-2" shape="rect"></a>
                  <p class="title">
                     <strong>Equation C.20.3-2. </strong>
                  </p>
                  <div class="equation-contents">
                     <span class="mathphrase">Number of Bytes = X<sub>D</sub> * Y<sub>D</sub> * Z<sub>D</sub> * 3 * 4</span>
                  </div>
               </div>
               <p>
                  <br class="equation-break" clear="none" />
                        </p>
            </div>
         </div>
      </div>
      <div class="navfooter">
         <hr />
         <table width="100%" summary="Navigation footer">
            <tr>
               <td width="40%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="sect_C.20.2.html" shape="rect">Prev</a> </td>
               <td width="20%" align="center" rowspan="1" colspan="1">
                  <a accesskey="u" href="sect_C.20.html" shape="rect">Up</a>
               </td>
               <td width="40%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="sect_C.21.html" shape="rect">Next</a>
               </td>
            </tr>
            <tr>
               <td width="40%" align="left" valign="top" rowspan="1" colspan="1">C.20.2 Spatial Registration Module </td>
               <td width="20%" align="center" rowspan="1" colspan="1">
                  <a accesskey="h" href="PS3.3.html" shape="rect">Home</a>
               </td>
               <td width="40%" align="right" valign="top" rowspan="1" colspan="1"> C.21 Spatial Fiducials</td>
            </tr>
         </table>
      </div>
      <table xmlns="" xmlns:d="http://docbook.org/ns/docbook" width="100%">
         <tr>
            <th colspan="1" align="center" rowspan="1">
               <span class="documentreleaseinformation">DICOM PS3.3 2024b - Information Object Definitions</span>
            </th>
         </tr>
      </table>
   </body>
</html>
