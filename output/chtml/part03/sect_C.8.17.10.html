<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>C.8.17.10 Ophthalmic Tomography Functional Group Macros</title>
      <link rel="stylesheet" type="text/css" href="dicom.css" />
      <meta name="generator" content="DocBook XSL Stylesheets V1.78.1" />
      <link rel="home" href="PS3.3.html" title="PS3.3" />
      <link rel="up" href="sect_C.8.17.html" title="C.8.17 Ophthalmic Photography and Tomography Modules" />
      <link rel="prev" href="sect_C.8.17.9.html" title="C.8.17.9 Ophthalmic Tomography Parameters Module" />
      <link rel="next" href="sect_C.8.17.11.html" title="C.8.17.11 Wide Field Ophthalmic Photography Stereographic Projection Module" />
      <style type="text/css"><![CDATA[
	p { font-size: 15px; }
      ]]></style>
   </head>
   <body>
      <table xmlns="" xmlns:d="http://docbook.org/ns/docbook" width="100%">
         <tr>
            <th colspan="1" align="center" rowspan="1">
               <span class="documentreleaseinformation">DICOM PS3.3 2024c - Information Object Definitions</span>
            </th>
         </tr>
      </table>
      <div xmlns="" class="navheader">
         <table width="100%" summary="Navigation header">
            <tr>
               <th colspan="3" align="center" rowspan="1">C.8.17.10 Ophthalmic Tomography Functional Group Macros <a accesskey="current" href="http://dicom.nema.org/medical/dicom/current/output/chtml/part03/sect_C.8.17.10.html" shape="rect">(Current)</a>
               </th>
            </tr>
            <tr>
               <td width="20%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="sect_C.8.17.9.html" shape="rect">Prev</a> </td>
               <th width="60%" align="center" rowspan="1" colspan="1">C.8.17 Ophthalmic Photography and Tomography Modules</th>
               <td width="20%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="sect_C.8.17.11.html" shape="rect">Next</a>
               </td>
            </tr>
         </table>
         <hr />
      </div>
      <div xmlns="" xmlns:d="http://docbook.org/ns/docbook" class="breadcrumbs">
         <span class="breadcrumb-link">
            <a href="PS3.3.html" shape="rect">PS3.3</a>
         </span> &gt; <span class="breadcrumb-link">
            <a href="chapter_C.html" shape="rect">Information Module Definitions (Normative)</a>
         </span> &gt; <span class="breadcrumb-link">
            <a href="sect_C.8.html" shape="rect">Modality Specific Modules</a>
         </span> &gt; <span class="breadcrumb-link">
            <a href="sect_C.8.17.html" shape="rect">Ophthalmic Photography and Tomography Modules</a>
         </span> &gt; <span class="breadcrumb-node">Ophthalmic Tomography Functional Group Macros</span>
      </div>
      <div class="section">
         <div class="titlepage">
            <div>
               <div>
                  <h4 class="title">
                     <a id="sect_C.8.17.10" shape="rect"></a>C.8.17.10 Ophthalmic Tomography Functional Group Macros</h4>
               </div>
            </div>
         </div>
         <div class="section">
            <div class="titlepage">
               <div>
                  <div>
                     <h5 class="title">
                        <a id="sect_C.8.17.10.1" shape="rect"></a>C.8.17.10.1 Ophthalmic Frame Location Macro</h5>
                  </div>
               </div>
            </div>
            <p>
               <a id="para_c1861d82-6f46-46c6-a26b-d2a4c434c5e3" shape="rect"></a>
                            <a class="xref" href="sect_C.8.17.10.html#table_C.8.17.10-1" title="Table C.8.17.10-1. Ophthalmic Frame Location Macro Attributes" shape="rect">Table C.8.17.10-1</a> specifies the Attributes of the <a class="xref" href="sect_C.8.17.10.html#sect_C.8.17.10.1" title="C.8.17.10.1 Ophthalmic Frame Location Macro" shape="rect">Ophthalmic Frame Location Macro</a>. This is used to provide a frame location relative to one or more referenced images. This Macro describes a frame perpendicular or parallel to the reference image; it describes column locations for frames that are scanned either uniformly along a line segment, or with a non-uniform spacing along any trajectory in the reference image.</p>
            <div class="table">
               <a id="table_C.8.17.10-1" shape="rect"></a>
               <p class="title">
                  <strong>Table C.8.17.10-1. Ophthalmic Frame Location Macro Attributes</strong>
               </p>
               <div class="table-contents">
                  <table frame="box" rules="all">
                     <thead>
                        <tr valign="top">
                           <th align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_20a09480-7ec7-41de-8f8b-bcd340147304" shape="rect"></a>Attribute Name</p>
                                    </th>
                           <th align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_02f5f34c-f453-42c0-a10f-17f07804478e" shape="rect"></a>Tag</p>
                                    </th>
                           <th align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_f45f4c69-17e6-4e18-ba9e-cad8e7f2f491" shape="rect"></a>Type</p>
                                    </th>
                           <th align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_3d455a13-2558-4978-b36a-e4c68b4571ba" shape="rect"></a>Attribute Description</p>
                                    </th>
                        </tr>
                     </thead>
                     <tbody>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_05ffe34b-6c0d-4e16-b6a6-8a06ea6db837" shape="rect"></a>Ophthalmic Frame Location Sequence</p>
                                    </td>
                           <td align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_4d0c0b6c-d944-41cf-ae38-5b49f8faf2e5" shape="rect"></a>(0022,0031)</p>
                                    </td>
                           <td align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_134c1f51-f121-47f3-95a1-6892dd5d1697" shape="rect"></a>1</p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_748000d8-6fcc-4fb4-9510-24e6160b0855" shape="rect"></a>Specifies the column locations for this frame in terms of locations on a referenced image.</p>
                                        <p>
                                 <a id="para_cc23ac8b-5ed5-4427-9f3c-7427994b27ed" shape="rect"></a>One or more Items shall be included in this Sequence.</p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" colspan="4" rowspan="1">
                                        <p>
                                 <a id="para_f487b0be-997b-4ecb-92f1-e8986ed578eb" shape="rect"></a>
                                            <span class="italic">&gt;Include <a class="xref" href="sect_10.3.html#table_10-3" title="Table 10-3. Image SOP Instance Reference Macro Attributes" shape="rect">Table 10-3 “Image SOP Instance Reference Macro Attributes”</a>
                                            </span>
                                        </p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_2169ceb0-fa1d-4e83-9542-b94fd92e4fcc" shape="rect"></a>&gt;Purpose of Reference Code Sequence</p>
                                    </td>
                           <td align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_7339aaad-32d5-4d19-8898-e727fdd999c4" shape="rect"></a>(0040,A170)</p>
                                    </td>
                           <td align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_c5af5111-b994-4cc2-99a5-48e91bf9a7f1" shape="rect"></a>3</p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_91cd5cd9-28ad-4348-9484-589b8669164f" shape="rect"></a>Describes the purpose for which the reference is made.</p>
                                        <p>
                                 <a id="para_e009f9b4-7fe6-450d-954f-6c8ce7f48c53" shape="rect"></a>Only a single Item is permitted in this Sequence.</p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" colspan="3" rowspan="1">
                                        <p>
                                 <a id="para_5ef232c1-3836-474c-a262-8f88b6bfda08" shape="rect"></a>
                                            <span class="italic">&gt;&gt;Include <a class="xref" href="sect_8.8.html#table_8.8-1" title="Table 8.8-1. Code Sequence Macro Attributes" shape="rect">Table 8.8-1 “Code Sequence Macro Attributes”</a>
                                            </span>
                                        </p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_5289ac18-b7ea-4cc8-8059-fb5586ce78b2" shape="rect"></a>
                                            <span class="italic">Defined Code Concept for Purpose of Reference is <a href="../part16/chapter_D.html#DCM_121311" class="olink" shape="rect">(121311, DCM, "Localizer")</a>.</span>
                                        </p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_94a251b9-f230-466c-bd66-5b31e29eecca" shape="rect"></a>&gt;Reference Coordinates</p>
                                    </td>
                           <td align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_3a4f8a17-8818-4052-9dd6-921c4ad5cb97" shape="rect"></a>(0022,0032)</p>
                                    </td>
                           <td align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_89b035aa-7251-46ac-b4ad-0fa4ab2c3964" shape="rect"></a>1</p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_2d9bfdc1-95f9-4d16-a93f-c12bb13274eb" shape="rect"></a>Image coordinates for the points on the referenced image that correspond to the points on this frame. See <a class="xref" href="sect_C.8.17.10.html#sect_C.8.17.10.1.1" title="C.8.17.10.1.1 Reference Coordinates" shape="rect">Section C.8.17.10.1.1</a>.</p>
                                        <p>
                                 <a id="para_bc68022b-5f97-41d7-a28f-1e1b38b601a2" shape="rect"></a>Multiple pairs of values where the first value of each pair is the row and the second value of each pair is the column. Row is the vertical offset and column is the horizontal offset.</p>
                                        <p>
                                 <a id="para_d5bb1de6-1ae5-43a4-9afd-a244f741e296" shape="rect"></a>Specified with sub-pixel resolution such that the origin at the Top Left Hand Corner (TLHC) of the TLHC pixel is 0.0\0.0, the Bottom Right Hand Corner (BRHC) of the TLHC pixel is 1.0\1.0, and the BRHC of the BRHC pixel is Rows\Columns (see <a class="xref" href="sect_C.10.5.html#figure_C.10.5-1" title="Figure C.10.5-1. Sub-pixel Addressing Units in PIXEL Space" shape="rect">Figure C.10.5-1</a>, except that row and column order is reversed). The values must be within the range 0\0 to Rows\Columns.</p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_34acfa76-f529-422e-ac57-6d12bb2c5209" shape="rect"></a>&gt;Depth of Transverse Image</p>
                                    </td>
                           <td align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_02fd9b39-5d00-4b06-9820-e309bcfbd9f2" shape="rect"></a>(0022,0041)</p>
                                    </td>
                           <td align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_33cf329f-98bc-436f-ab15-de33d2c68bcd" shape="rect"></a>2C</p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_73e976e1-943e-4059-be0e-65b5984178db" shape="rect"></a>Relative position in µm signifying the location of a Transverse image in the z-axis. Required if Ophthalmic Image Orientation (0022,0039) is TRANSVERSE.</p>
                                    </td>
                        </tr>
                        <tr valign="top">
                           <td align="left" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_8ce407c9-b717-4af1-ad19-19a5d14d5fa9" shape="rect"></a>&gt;Ophthalmic Image Orientation</p>
                                    </td>
                           <td align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_81d8e83b-6fe1-4381-9f35-9646fbf2ad8d" shape="rect"></a>(0022,0039)</p>
                                    </td>
                           <td align="center" rowspan="1" colspan="1">
                                        <p>
                                 <a id="para_7ba3d424-8341-4602-8f38-3418e98e61ab" shape="rect"></a>1</p>
                                    </td>
                           <td align="left" rowspan="1" colspan="1">
                                        <div class="variablelist">
                                 <p class="title">
                                    <strong>Enumerated Values:</strong>
                                 </p>
                                 <dl class="variablelist compact">
                                    <dt>
                                       <span class="term">LINEAR</span>
                                    </dt>
                                    <dd>
                                       <p>
                                          <a id="para_2291c897-6ee9-4b4d-961a-ece3bd98f5d9" shape="rect"></a>
                                       </p>
                                    </dd>
                                    <dt>
                                       <span class="term">NONLINEAR</span>
                                    </dt>
                                    <dd>
                                       <p>
                                          <a id="para_67b92fe5-9ba8-4b07-b8f3-9fd31bd7e157" shape="rect"></a>
                                       </p>
                                    </dd>
                                    <dt>
                                       <span class="term">TRANSVERSE</span>
                                    </dt>
                                    <dd>
                                       <p>
                                          <a id="para_6586a497-598a-4e05-afea-d3c38af180e2" shape="rect"></a>
                                       </p>
                                    </dd>
                                 </dl>
                              </div>
                                    </td>
                        </tr>
                     </tbody>
                  </table>
               </div>
            </div>
            <br class="table-break" clear="none" />
            <div class="section">
               <div class="titlepage">
                  <div>
                     <div>
                        <h6 class="title">
                           <a id="sect_C.8.17.10.1.1" shape="rect"></a>C.8.17.10.1.1 Reference Coordinates</h6>
                     </div>
                  </div>
               </div>
               <p>
                  <a id="para_1dc8cc6d-3488-4d98-b48e-702dbe938e13" shape="rect"></a>A frame can be described in terms of its "position" on another image. In the case of ophthalmic tomography (OPT) images with longitudinal orientation, the OPT image corresponds to a vertical slice along a trajectory on the referenced image. Each column of the OPT frame is nominally perpendicular to the image. Therefore, each column of the OPT frame can also correspond to a particular pixel on an associated image. It is normal in OPT analysis to indicate the location of the OPT slice by showing the corresponding pixel locations on the image. For Transverse frames, the position is indicated by two corners of a rectangle.</p>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Note</h3>
                  <p>
                     <a id="para_35920d4b-9876-4b52-b4ef-22fc68f1ea5b" shape="rect"></a>The simple geometric relationship Modules are not practical to use for describing the relationship between OPT and retinal photography images. The retinal surface is highly curved, and the optical path is influenced by the lens and other eye structures. It is impractical to measure all of the geometric and optical properties of the eye to the degree needed to establish the relationship by geometric computation. It is easy to capture a retinal image and the slice path on that image as part of the OPT acquisition.</p>
               </div>
               <p>
                  <a id="para_7bddc139-8afd-4e74-a729-1683422a1e99" shape="rect"></a>The OPT columns for a retinal slice are not strictly perpendicular to the retina and there are minor systematic distortions as a result. This DICOM Functional Group does not attempt to capture the data needed to measure or correct for these effects, except for the presence of the Maximum Along-scan Distortion Attribute (0022,0038).</p>
               <p>
                  <a id="para_ca02aede-24f9-4c86-9583-922717a66849" shape="rect"></a>The relationship between the columns in the image frame and the reference image are illustrated in <a class="xref" href="sect_C.8.17.10.html#figure_C.8.17.10-1" title="Figure C.8.17.10-1. Relationship of Longitudinal (Nominally Perpendicular) OCT Frames to Reference Frame" shape="rect">Figure C.8.17.10-1</a>.</p>
               <p>
                  <a id="para_7486ab4b-f840-4337-be19-0a40ba4b0963" shape="rect"></a>Frames can be captured using a linear scan with uniform column spacing. This permits the column position to be described by giving the endpoints of the line segment that was scanned. <a class="xref" href="sect_C.8.17.10.html#figure_C.8.17.10-1" title="Figure C.8.17.10-1. Relationship of Longitudinal (Nominally Perpendicular) OCT Frames to Reference Frame" shape="rect">Figure C.8.17.10-1</a> shows such a scan labeled as "OCT Frame 1". When describing this frame using the Linear Column Locations Functional Group Macro, the Sequence Attributes would contain:</p>
               <div class="orderedlist">
                  <ol class="orderedlist" type="a">
                     <li class="listitem">
                        <p>
                           <a id="para_5fc17661-6952-493a-af41-4254939a582f" shape="rect"></a>The Attributes of the Image SOP Instance Reference Macro would point to a frame of the reference image.</p>
                     </li>
                     <li class="listitem">
                        <p>
                           <a id="para_ca4f95e8-3e3b-48cc-b4e4-ec7b4f1b86c4" shape="rect"></a>Reference Coordinates (0022,0032) would contain values that give the row and column coordinates for the image pixel on the referenced image that corresponds to the first column of the OPT Frame 1 and the row and column coordinates that corresponds to the last column of the OPT Frame 1.</p>
                     </li>
                  </ol>
               </div>
               <p>
                  <a id="para_210d58bb-023c-4976-8b44-8d2182bfbbd2" shape="rect"></a>Frames can also be taken along curved paths, or with non-uniform spacing. These frames cannot be described by just the two endpoints. These frames are described by specifying the referenced image pixel coordinates for each column in the frame. The frame labeled "OCT Frame 2" illustrates this kind of relationship. The Non-linear Column Locations Functional Group Macro description for this frame would contain:</p>
               <div class="orderedlist">
                  <ol class="orderedlist" type="a">
                     <li class="listitem">
                        <p>
                           <a id="para_a803274f-1b07-4e9b-8144-c9f75cceb678" shape="rect"></a>The Attributes of the Image SOP Instance Reference Macro would point to a frame of the reference image.</p>
                     </li>
                     <li class="listitem">
                        <p>
                           <a id="para_088e5ea6-d5c6-4f33-9208-2b2b7077c4f9" shape="rect"></a>Reference Coordinates (0022,0032) would contain 2N integer values. Their contents would be:</p>
                        <p>
                           <a id="para_87530eb5-2db0-4c8b-982a-8299dd2ebf37" shape="rect"></a>1-2 (e,f)</p>
                        <p>
                           <a id="para_c54ae652-141f-46f1-827c-28f6c5d06f66" shape="rect"></a>… other values</p>
                        <p>
                           <a id="para_97df1126-6920-4faa-98bd-5dbaec80e1cf" shape="rect"></a>2L-1, 2L (g,h)</p>
                        <p>
                           <a id="para_2b57803e-06d3-4116-9c14-2c410252c07f" shape="rect"></a>… other values</p>
                        <p>
                           <a id="para_229af458-8ad3-4169-a89a-4c1c397acf24" shape="rect"></a>2N-1, 2N (x,y)</p>
                     </li>
                  </ol>
               </div>
               <p>
                  <a id="para_b1135926-fe58-4eaf-bad2-6db41099b426" shape="rect"></a>A three dimensional OPT raster scan image would be described by a series of Linear Column Location Sequences, one for each frame.</p>
               <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
                  <h3 class="title">Note</h3>
                  <p>
                     <a id="para_bc03d543-6fb1-402d-9ea0-89ed337133cd" shape="rect"></a>One expected use of column location is the automatic generation of annotation graphics display. The slice location can be indicated and dynamically controlled on the reference image while examining the observed slices. This replaces the relatively inflexible practice of creating a modified retinal image with burned in annotation to indicate the slice locations.</p>
               </div>
               <p>
                  <a id="para_228d92ba-d603-402c-9b73-b4bddb1819a0" shape="rect"></a>
                                </p>
               <div class="figure">
                  <a id="figure_C.8.17.10-1" shape="rect"></a>
                  <div class="figure-contents">
                     <div class="mediaobject">
                        <img src="figures/PS3.3_C.8.17.10-1.svg" alt="Relationship of Longitudinal (Nominally Perpendicular) OCT Frames to Reference Frame" />
                     </div>
                  </div>
                  <p class="title">
                     <strong>Figure C.8.17.10-1. Relationship of Longitudinal (Nominally Perpendicular) OCT Frames to Reference Frame</strong>
                  </p>
               </div>
               <p>
                  <br class="figure-break" clear="none" />
                            </p>
               <p>
                  <a id="para_a8b86f71-9f92-47f5-bb9a-ce4940ab70da" shape="rect"></a>In the case of ophthalmic tomography (OPT) images with a transverse orientation, the OPT image corresponds to a sub-rectangle of the reference image. See <a class="xref" href="sect_C.8.17.10.html#figure_C.8.17.10-2" title="Figure C.8.17.10-2. Relationship of Transverse (Nominally Parallel) OCT Frame to Reference Frame" shape="rect">Figure C.8.17.10-2</a>. The OPT frame is nominally parallel to the reference image. Therefore, each corner of the OPT frame can also correspond to a particular pixel on an associated image. It is assumed that the edges of OPT frame are exactly parallel to the edges of the reference image.</p>
               <p>
                  <a id="para_70690832-f13c-4d3f-b4ae-17b1ccbe0609" shape="rect"></a>
                                </p>
               <div class="figure">
                  <a id="figure_C.8.17.10-2" shape="rect"></a>
                  <div class="figure-contents">
                     <div class="mediaobject">
                        <img src="figures/PS3.3_C.8.17.10-2.svg" alt="Relationship of Transverse (Nominally Parallel) OCT Frame to Reference Frame" />
                     </div>
                  </div>
                  <p class="title">
                     <strong>Figure C.8.17.10-2. Relationship of Transverse (Nominally Parallel) OCT Frame to Reference Frame</strong>
                  </p>
               </div>
               <p>
                  <br class="figure-break" clear="none" />
                            </p>
            </div>
         </div>
      </div>
      <div class="navfooter">
         <hr />
         <table width="100%" summary="Navigation footer">
            <tr>
               <td width="40%" align="left" rowspan="1" colspan="1">
                  <a accesskey="p" href="sect_C.8.17.9.html" shape="rect">Prev</a> </td>
               <td width="20%" align="center" rowspan="1" colspan="1">
                  <a accesskey="u" href="sect_C.8.17.html" shape="rect">Up</a>
               </td>
               <td width="40%" align="right" rowspan="1" colspan="1"> <a accesskey="n" href="sect_C.8.17.11.html" shape="rect">Next</a>
               </td>
            </tr>
            <tr>
               <td width="40%" align="left" valign="top" rowspan="1" colspan="1">C.8.17.9 Ophthalmic Tomography Parameters Module </td>
               <td width="20%" align="center" rowspan="1" colspan="1">
                  <a accesskey="h" href="PS3.3.html" shape="rect">Home</a>
               </td>
               <td width="40%" align="right" valign="top" rowspan="1" colspan="1"> C.8.17.11 Wide Field Ophthalmic Photography Stereographic Projection Module</td>
            </tr>
         </table>
      </div>
      <table xmlns="" xmlns:d="http://docbook.org/ns/docbook" width="100%">
         <tr>
            <th colspan="1" align="center" rowspan="1">
               <span class="documentreleaseinformation">DICOM PS3.3 2024c - Information Object Definitions</span>
            </th>
         </tr>
      </table>
   </body>
</html>
